<!DOCTYPE html>
<html>
<head>
    <title>Text Generator Panel</title>
</head>
<body>
<h3>Text Generator</h3>

<!-- Model selection -->
<label for="model">Choose a model:</label>
<select id="model">
    <option value="gpt2-large">GPT-2 0.7B</option>
    <option value="opt-1b">OPT 1.3B</option>
    <option value="phi-1b">Phi 1.3B</option>
    <option value="bloom-1b">Bloom 1.7B</option>
</select>
<br><br>

<!-- Num tokens input -->
<label for="num_tokens">Number of tokens:</label>
<input type="number" id="num_tokens" value="32">
<br><br>

<!-- Text input -->
<label for="text">Input text:</label><br>
<textarea id="text" rows="4" cols="50"></textarea>
<br><br>

<!-- Run button -->
<button id="runText" onclick="runStream()">Run Text Generator</button>

<pre id="output" style="background:#f0f0f0; padding:10px;"></pre>

<script>
async function runStream() {
  const model = document.getElementById("model").value;
  const num_tokens = document.getElementById("num_tokens").value;
  const text = document.getElementById("text").value;

  const payload = { model, num_tokens, text };
  const output = document.getElementById("output");
  output.textContent = "Generating...\n";

  // Change this to YOUR Cloudflare tunneled endpoint
  const url = "https://developed-mysql-dice-converter.trycloudflare.com/run";

  const response = await fetch(url, {
    method: "POST",
    headers: {
      "x-secret": "skrkhfwk",
      "Content-Type": "application/json"
    },
    body: JSON.stringify(payload)
  });

  if (!response.ok) {
    output.textContent = "Error: " + response.status;
    return;
  }

  const reader = response.body.getReader();
  const decoder = new TextDecoder();

  output.textContent = ""; // clear previous output

  while (true) {
    const { done, value } = await reader.read();
    if (done) break;

    const chunk = decoder.decode(value);
    output.textContent += chunk;
  }
}
</script>

</body>
</html>
